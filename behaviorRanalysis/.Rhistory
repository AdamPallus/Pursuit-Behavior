setwd('./GitHub/Pursuit-Behavior/behaviorRanalysis')
setwd('/GitHub/Pursuit-Behavior/behaviorRanalysis')
getwd()
library(ggplot2)
library(dplyr)
library(tidyr)
library(xtable)
filename<-"behaviormeasured.csv"
d <- read.csv(filename, na.strings="NaN")
head(d)
g<-ggplot(aes(pursuit_velocity,hpeak),data=d)
g+geom_boxplot(color=iep)
g+geom_boxplot(color=d$iep)
g+geom_boxplot()
g+geom_point()
g<-ggplot(aes(factor(pursuit_velocity),hpeak),data=d)
g+geom_point()
g+geom_boxplot()
g+geom_boxplot(fill=d$stepramp)
g+geom_boxplot(fill=factor(d$stepramp)
)
)
qplot(pursuit_velocity,hpeak,data=d)
qplot(pursuit_velocity,hpeak,data=d,color=iep)
qplot(pursuit_velocity,hpeak,data=subset(d,stepramp==0),color=iep,geom='boxplot')
qplot(pursuit_velocity,hpeak,data=subset(d,stepramp==0),geom='boxplot')
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==0),geom='boxplot')
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==0),geom='boxplot',fill=iep)
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==0),geom='boxplot',fill=factor(iep)
)
dd<-subset(d,mod(pursuit_velocity,5)==0)
dd<-subset(d,pursuit_velocity%%5==0)
qplot(factor(pursuit_velocity),hpeak,data=subset(dd,stepramp==0),geom='boxplot',fill=factor(iep))
qplot(factor(pursuit_velocity),hpeak,data=subset(dd,stepramp==0),geom='boxplot',fill=factor(iep))+coord_cartesian(xlim = c(-400,400))
qplot(factor(pursuit_velocity),hpeak,data=subset(dd,stepramp==0),geom='boxplot',fill=factor(iep))+coord_cartesian(ylim = c(-400,400))
qplot(factor(pursuit_velocity),hpeak,data=subset(dd,stepramp==0),geom='boxplot',fill=factor(iep))+coord_cartesian(ylim = c(-350,350))
dd$iepc<-dd$iep*sign(dd$pursuit_velocity)
qplot(factor(pursuit_velocity),hpeak,data=subset(dd,stepramp==0),geom='boxplot',fill=factor(iepc))+coord_cartesian(ylim = c(-350,350))
d <- read.csv(filename, na.strings="NaN")
r<-read.csv('peakregressions.csv')
d<-subset(d,pursuit_velocity%%5==0)
d$iep<as.factor(d$iep*sign(d.pursuit_velocity))
qplot(factor(pursuit_velocity),hpeak,data=subset(dd,stepramp==0),geom='boxplot',fill=factor(iep))+coord_cartesian(ylim = c(-350,350))
d$iep<as.factor(d$iep*sign(d$pursuit_velocity))
qplot(factor(pursuit_velocity),hpeak,data=subset(dd,stepramp==0),geom='boxplot',fill=factor(iep))+coord_cartesian(ylim = c(-350,350))
d$iep<-as.factor(d$iep*sign(d$pursuit_velocity))
qplot(factor(pursuit_velocity),hpeak,data=subset(dd,stepramp==0),geom='boxplot',fill=factor(iep))+coord_cartesian(ylim = c(-350,350))
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==1),geom='boxplot',fill=factor(iep))+coord_cartesian(ylim = c(-350,350))
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==1),geom='boxplot',fill=factor(iep))+coord_cartesian(ylim = c(-300,300))
head(d)
qplot(factor(pursuit_velocity),hstart,data=subset(d,stepramp==0),geom='boxplot',fill=factor(iep))+coord_cartesian(ylim = c(-300,300))
qplot(factor(pursuit_velocity),hstart,data=subset(d,stepramp==0),geom='boxplot',fill=factor(iep))
qplot(iep,hstart,data=subset(d,stepramp==0),geom='boxplot')
qplot(iep,gamp1,data=subset(d,stepramp==0),geom='boxplot')
qplot(iep,pursuit_start,data=subset(d,stepramp==0),geom='boxplot')
aov(iep~pursuit_start,data=subset(d,stepramp==0))
aov(iep~pursuit_start,data=d)
aov(iep+1~pursuit_start,data=subset(d,stepramp==0))
levels(d$iep)
levels(d$iep)<-c('backward','centered','foward')
levels(d$iep)
aov(iep~pursuit_start,data=d)
aov(pursuit_start~iep,data=subset(d,stepramp==0))
a<-aov(pursuit_start~iep,data=subset(d,stepramp==0))
summary(a)
qplot(iep,gamp1,data=subset(d,stepramp==0),geom='boxplot')
qplot(iep,gamp1,data=subset(d,stepramp==1),geom='boxplot')
head(d)
max(d$stepdirection)
min(d$stepdirection)
d$stepdirection<-factor(d$stepdirection)
levels(d$stepdirection)
levels(d$stepdirection)<-c('backward','none','forward')
levels(d$stepdirection)
qplot(stepdirection,gamp1,data=subset(d,stepramp==1),geom='boxplot')
qplot(stepdirection,gamp1,data=subset(d,stepramp==1),geom='boxplot',facets=.~factor(sign(pursuit_velocity)))
head(d)
d$direction<-as.facto(sign(d$pursuit_velocity))
d$direction<-as.factor(sign(d$pursuit_velocity))
d$direction<-sign(d$pursuit_velocity)
qplot(stepdirection,gamp1*direction,data=subset(d,stepramp==1),geom='boxplot',facets=.~factor(sign(pursuit_velocity)))
qplot(stepdirection,gamp1*direction,data=subset(d,stepramp==1),geom='boxplot')
dsr<-subset(d,stepramp==1 & iep=='centered')
qplot(factor(pursuit_velocity),hpeak,data=dsr)
qplot(factor(pursuit_velocity),hpeak,data=dsr,geom='boxplot',fill=stepdirection)
library(ggplot2)
library(dplyr)
library(tidyr)
library(xtable)
filename<-"~/GitHub/Pursuit-Behavior/behaviorRanalysis/behaviormeasured.csv"
d <- read.csv(filename, na.strings="NaN")
qplot(stepdirection,gamp1*direction,data=dsr,geom='boxplot')
qplot(stepdirection,gamp1,data=dsr,geom='boxplot',facets=.~direction)
d$pursuit_direction<-as.factor(d$direction)
levels(d$pursuit_direction)<-c('leftward','rightward')
qplot(stepdirection,gamp1,data=dsr,geom='boxplot',facets=.~pursuit_direction)
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward','rightward')
qplot(stepdirection,gamp1,data=dsr,geom='boxplot',facets=.~pursuit_direction)
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward.pursuit','rightward.pursuit')
qplot(stepdirection,gamp1,data=dsr,geom='boxplot',facets=.~pursuit_direction)
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward.pursuit','rightward.pursuit')
qplot(stepdirection,gamp1,data=dsr,geom='boxplot',fill=pursuit_direction)
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward.pursuit','rightward.pursuit')
qplot(stepdirection,abs(gamp1),data=dsr,geom='boxplot',fill=pursuit_direction)
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward.pursuit','rightward.pursuit')
qplot(stepdirection,gamp1*direction,data=dsr,geom='boxplot',fill=pursuit_direction)
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward.pursuit','rightward.pursuit')
qplot(stepdirection,gamp1*direction,data=dsr,geom='boxplot',fill=pursuit_direction,facets=.~monkey)
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward.pursuit','rightward.pursuit')
qplot(stepdirection,gamp1*direction,data=dsr,geom='boxplot',fill=pursuit_direction,facets=monkey~.)
scale_fill_manual(values=c('#0000FF','#BE00BE','#FF0000','#000000'))
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward.pursuit','rightward.pursuit')
qplot(stepdirection,gamp1*direction,data=dsr,geom='boxplot',fill=pursuit_direction,facets=monkey~.)
dsr$pursuit_direction<-as.factor(dsr$direction)
levels(dsr$pursuit_direction)<-c('leftward.pursuit','rightward.pursuit')
qplot(stepdirection,gamp1*direction,data=dsr,geom='boxplot',fill=pursuit_direction,facets=monkey~.)+scale_fill_manual(values=c('#0000FF','#BE00BE','#FF0000','#000000'))
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==0 & direction==-1),geom='boxplot',fill=factor(iep),facets=monkey~.)
+coord_cartesian(ylim = c(-300,0))
+scale_fill_manual(values=cpal)
+geom_boxplot(outlier.size=1)
d<-subset(d,pursuit_velocity%%5==0)
d$iep<-as.factor(d$iep*sign(d$pursuit_velocity))
levels(d$iep)<-c('backward','centered','forward')
d$direction<-sign(d$pursuit_velocity)
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==0 & direction==-1),geom='boxplot',fill=factor(iep),facets=monkey~.)
+coord_cartesian(ylim = c(-300,0))
+scale_fill_manual(values=cpal)
+geom_boxplot(outlier.size=1)
d<-subset(d,pursuit_velocity%%5==0)
d$iep<-as.factor(d$iep*sign(d$pursuit_velocity))
levels(d$iep)<-c('backward','centered','forward')
d$direction<-sign(d$pursuit_velocity)
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==0 & direction==-1),geom='boxplot',fill=factor(iep),facets=monkey~.)+coord_cartesian(ylim = c(-300,0))+scale_fill_manual(values=cpal)+geom_boxplot(outlier.size=1)
cpal<-c('#0000FF','#BE00BE','#FF0000','#000000')
d<-subset(d,pursuit_velocity%%5==0)
d$iep<-as.factor(d$iep*sign(d$pursuit_velocity))
levels(d$iep)<-c('backward','centered','forward')
d$direction<-sign(d$pursuit_velocity)
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==0 & direction==-1),geom='boxplot',fill=factor(iep),facets=monkey~.)+coord_cartesian(ylim = c(-300,0))+scale_fill_manual(values=cpal)+geom_boxplot(outlier.size=1)
qplot(factor(pursuit_velocity),hpeak,data=subset(d,stepramp==0 & direction==-1),fill=factor(iep),facets=monkey~.)+
qplot(stepdirection,hstart,data=dsr,geom='boxplot',fill=monkey,facets=.~pursuit_direction)+scale_fill_manual(values=cpal)+
theme(axis.text.x = element_text(angle = 20, vjust = 0.5, hjust=0.5))+
xlabel('Step Direction')+
ylabel('Head Movement Latency')
qplot(stepdirection,hstart,data=dsr,geom='boxplot',fill=monkey,facets=.~pursuit_direction)+scale_fill_manual(values=cpal)+
theme(axis.text.x = element_text(angle = 20, vjust = 0.5, hjust=0.5))+
xlab('Step Direction')+
ylab('Head Movement Latency')
qplot(stepdirection,hstart,data=dsr,geom='boxplot',fill=monkey,facets=.~pursuit_direction)+scale_fill_manual(values=cpal)+
theme(axis.text.x = element_text(angle = 20, vjust = 0.5, hjust=0.5))+
xlab('Step Direction')+
ylab('Head Latency (ms)')
dsr$hpeak[hpeak<10]<-NA
qplot(stepdirection,hstart,data=dsr,geom='jitter',fill=monkey,facets=.~pursuit_direction)+scale_fill_manual(values=cpal)+
theme(axis.text.x = element_text(angle = 20, vjust = 0.5, hjust=0.5))+
xlab('Step Direction')+
ylab('Head Latency (ms)')
dsr$hstart[hstart<10]<-NA
qplot(stepdirection,hstart,data=dsr,geom='boxplot',fill=monkey,facets=.~pursuit_direction)+scale_fill_manual(values=cpal)+
theme(axis.text.x = element_text(angle = 20, vjust = 0.5, hjust=0.5))+
xlab('Step Direction')+
ylab('Head Latency (ms)')
